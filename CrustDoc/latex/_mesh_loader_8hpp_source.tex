\hypertarget{_mesh_loader_8hpp_source}{}\doxysection{Mesh\+Loader.\+hpp}
\label{_mesh_loader_8hpp_source}\index{/Users/karolborecki/Desktop/CrustEngine/CrustEngine/Inc/Files/MeshLoader.hpp@{/Users/karolborecki/Desktop/CrustEngine/CrustEngine/Inc/Files/MeshLoader.hpp}}
\mbox{\hyperlink{_mesh_loader_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{preprocessor}{\#ifndef \_MESHLOADER\_HPP\_}}
\DoxyCodeLine{2 \textcolor{preprocessor}{\#define \_MESHLOADER\_HPP\_}}
\DoxyCodeLine{3 }
\DoxyCodeLine{4 \textcolor{preprocessor}{\#include <fstream>}}
\DoxyCodeLine{5 \textcolor{preprocessor}{\#include <string>}}
\DoxyCodeLine{6 \textcolor{preprocessor}{\#include <vector>}}
\DoxyCodeLine{7 }
\DoxyCodeLine{8 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{_exceptions_handler_8hpp}{Logging/ExceptionsHandler.hpp}}>}}
\DoxyCodeLine{9 }
\DoxyCodeLine{13 \textcolor{keyword}{class }\mbox{\hyperlink{class_mesh_loader}{MeshLoader}}}
\DoxyCodeLine{14 \{}
\DoxyCodeLine{15 \textcolor{keyword}{public}:}
\DoxyCodeLine{25   \textcolor{keyword}{static} \textcolor{keywordtype}{void} \mbox{\hyperlink{class_mesh_loader_a79900851f6165bcdca8eecae4c5b452b}{LoadMeshFromFile}}(\textcolor{keyword}{const} \textcolor{keywordtype}{char} *fileName, \mbox{\hyperlink{class_mesh}{Mesh}} *outMesh);}
\DoxyCodeLine{26 }
\DoxyCodeLine{27 \textcolor{keyword}{private}:}
\DoxyCodeLine{36   \textcolor{keyword}{static} \textcolor{keywordtype}{void} ParseObjToMesh(\textcolor{keyword}{const} \textcolor{keywordtype}{char} *fileName, \mbox{\hyperlink{class_mesh}{Mesh}} *outMesh);}
\DoxyCodeLine{37 \};}
\DoxyCodeLine{38 }
\DoxyCodeLine{39 \textcolor{keywordtype}{void} \mbox{\hyperlink{class_mesh_loader_a79900851f6165bcdca8eecae4c5b452b}{MeshLoader::LoadMeshFromFile}}(\textcolor{keyword}{const} \textcolor{keywordtype}{char} *fileName, \mbox{\hyperlink{class_mesh}{Mesh}} *outMesh)}
\DoxyCodeLine{40 \{}
\DoxyCodeLine{41   uint8\_t fileNameLen = strlen(fileName);}
\DoxyCodeLine{42 }
\DoxyCodeLine{43   \textcolor{keywordflow}{if} (fileName[fileNameLen -\/ 1] == \textcolor{charliteral}{'j'} \&\& fileName[fileNameLen -\/ 2] == \textcolor{charliteral}{'b'} \&\& fileName[fileNameLen -\/ 3] == \textcolor{charliteral}{'o'} \&\& fileName[fileNameLen -\/ 4] == \textcolor{charliteral}{'.'})}
\DoxyCodeLine{44     ParseObjToMesh(fileName, outMesh);}
\DoxyCodeLine{45   \textcolor{keywordflow}{else}}
\DoxyCodeLine{46     \mbox{\hyperlink{class_exceptions_handler_a86c95e07ec62093a3183476202e464bc}{ExceptionsHandler::ThrowWarning}}(\textcolor{stringliteral}{"{}No mathing file extension for file: \%s -\/ The mesh will not be loaded."{}}, fileName);}
\DoxyCodeLine{47 \}}
\DoxyCodeLine{48 }
\DoxyCodeLine{49 \textcolor{keywordtype}{void} MeshLoader::ParseObjToMesh(\textcolor{keyword}{const} \textcolor{keywordtype}{char} *fileName, \mbox{\hyperlink{class_mesh}{Mesh}} *outMesh)}
\DoxyCodeLine{50 \{}
\DoxyCodeLine{51   std::ifstream file(fileName);}
\DoxyCodeLine{52   std::string line;}
\DoxyCodeLine{53   \textcolor{keyword}{const} \textcolor{keywordtype}{char} *analysed\_line;}
\DoxyCodeLine{54 }
\DoxyCodeLine{55   \textcolor{keywordtype}{char} str[256];}
\DoxyCodeLine{56   \textcolor{keywordtype}{double} x = 1.0, y = 1.0, z = 1.0;             \textcolor{comment}{// Points values}}
\DoxyCodeLine{57   \textcolor{keywordtype}{int} p1\_index = 1, p2\_index = 1, p3\_index = 1; \textcolor{comment}{// Points indexes}}
\DoxyCodeLine{58   \textcolor{keywordtype}{int} t1\_index = 1, t2\_index = 1, t3\_index = 1; \textcolor{comment}{// Textures indexes}}
\DoxyCodeLine{59   \textcolor{keywordtype}{int} n1\_index = 1, n2\_index = 1, n3\_index = 1; \textcolor{comment}{// Normals indexes}}
\DoxyCodeLine{60 }
\DoxyCodeLine{61   std::vector<double> points;}
\DoxyCodeLine{62 }
\DoxyCodeLine{63   \textcolor{keywordtype}{int} currentPoint = 0;}
\DoxyCodeLine{64   \textcolor{keywordtype}{int} currentTri = 0;}
\DoxyCodeLine{65 }
\DoxyCodeLine{66   \textcolor{keywordflow}{while} (std::getline(file, line))}
\DoxyCodeLine{67   \{}
\DoxyCodeLine{68 }
\DoxyCodeLine{69     analysed\_line = line.c\_str();}
\DoxyCodeLine{70     \textcolor{keywordflow}{if} (sscanf(analysed\_line, \textcolor{stringliteral}{"{}v \%lf \%lf \%lf"{}}, \&x, \&y, \&z) == 3)}
\DoxyCodeLine{71     \{}
\DoxyCodeLine{72       points.push\_back(x);}
\DoxyCodeLine{73       points.push\_back(y);}
\DoxyCodeLine{74       points.push\_back(z);}
\DoxyCodeLine{75     \}}
\DoxyCodeLine{76     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (sscanf(analysed\_line, \textcolor{stringliteral}{"{}vn \%lf \%lf \%lf"{}}, \&x, \&y, \&z) == 3)}
\DoxyCodeLine{77     \{}
\DoxyCodeLine{78       \textcolor{comment}{// TODO mesh obj loader -\/ usage for vn data}}
\DoxyCodeLine{79     \}}
\DoxyCodeLine{80     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (sscanf(analysed\_line, \textcolor{stringliteral}{"{}vt \%lf \%lf \%lf"{}}, \&x, \&y, \&z) == 3)}
\DoxyCodeLine{81     \{}
\DoxyCodeLine{82       \textcolor{comment}{// TODO mesh obj loader -\/ usage for vt data}}
\DoxyCodeLine{83     \}}
\DoxyCodeLine{84     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (sscanf(analysed\_line, \textcolor{stringliteral}{"{}f \%d \%d \%d"{}}, \&p1\_index, \&p2\_index, \&p3\_index) == 3)}
\DoxyCodeLine{85     \{}
\DoxyCodeLine{86       \textcolor{comment}{// TODO rework this}}
\DoxyCodeLine{87       outMesh-\/>\mbox{\hyperlink{class_mesh_ac3b13bffa35d0d581ffe1e0dc8479584}{AddPolygon}}(*(\textcolor{keyword}{new} \mbox{\hyperlink{class_polygon}{Polygon}}(points[(p1\_index -\/ 1) * 3], points[(p1\_index -\/ 1) * 3 + 1], points[(p1\_index -\/ 1) * 3 + 2], \textcolor{comment}{// TODO make static polygon and pass it as copy}}
\DoxyCodeLine{88                                         points[(p2\_index -\/ 1) * 3], points[(p2\_index -\/ 1) * 3 + 1], points[(p2\_index -\/ 1) * 3 + 2],}
\DoxyCodeLine{89                                         points[(p3\_index -\/ 1) * 3], points[(p3\_index -\/ 1) * 3 + 1], points[(p3\_index -\/ 1) * 3 + 2])));}
\DoxyCodeLine{90     \}}
\DoxyCodeLine{91     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (sscanf(analysed\_line, \textcolor{stringliteral}{"{}f \%d/\%d \%d/\%d \%d/\%d"{}}, \&p1\_index, \&t1\_index, \&p2\_index, \&t2\_index, \&p3\_index, \&t3\_index) == 6)}
\DoxyCodeLine{92     \{}
\DoxyCodeLine{93       outMesh-\/>\mbox{\hyperlink{class_mesh_ac3b13bffa35d0d581ffe1e0dc8479584}{AddPolygon}}(*(\textcolor{keyword}{new} \mbox{\hyperlink{class_polygon}{Polygon}}(points[(p1\_index -\/ 1) * 3], points[(p1\_index -\/ 1) * 3 + 1], points[(p1\_index -\/ 1) * 3 + 2],}
\DoxyCodeLine{94                                         points[(p2\_index -\/ 1) * 3], points[(p2\_index -\/ 1) * 3 + 1], points[(p2\_index -\/ 1) * 3 + 2],}
\DoxyCodeLine{95                                         points[(p3\_index -\/ 1) * 3], points[(p3\_index -\/ 1) * 3 + 1], points[(p3\_index -\/ 1) * 3 + 2])));}
\DoxyCodeLine{96     \}}
\DoxyCodeLine{97     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (sscanf(analysed\_line, \textcolor{stringliteral}{"{}f \%d/\%d/\%d \%d/\%d/\%d \%d/\%d/\%d"{}}, \&p1\_index, \&t1\_index, \&n1\_index, \&p2\_index, \&t2\_index, \&n2\_index, \&p3\_index, \&t3\_index, \&n3\_index) == 9)}
\DoxyCodeLine{98     \{}
\DoxyCodeLine{99       outMesh-\/>\mbox{\hyperlink{class_mesh_ac3b13bffa35d0d581ffe1e0dc8479584}{AddPolygon}}(*(\textcolor{keyword}{new} \mbox{\hyperlink{class_polygon}{Polygon}}(points[(p1\_index -\/ 1) * 3], points[(p1\_index -\/ 1) * 3 + 1], points[(p1\_index -\/ 1) * 3 + 2],}
\DoxyCodeLine{100                                         points[(p2\_index -\/ 1) * 3], points[(p2\_index -\/ 1) * 3 + 1], points[(p2\_index -\/ 1) * 3 + 2],}
\DoxyCodeLine{101                                         points[(p3\_index -\/ 1) * 3], points[(p3\_index -\/ 1) * 3 + 1], points[(p3\_index -\/ 1) * 3 + 2])));}
\DoxyCodeLine{102     \}}
\DoxyCodeLine{103     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (sscanf(analysed\_line, \textcolor{stringliteral}{"{}usemtl \%s"{}}, str) == 1)}
\DoxyCodeLine{104     \{}
\DoxyCodeLine{105       \textcolor{comment}{// TODO mesh obj loader -\/ usage for usemtl data}}
\DoxyCodeLine{106     \}}
\DoxyCodeLine{107     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (sscanf(analysed\_line, \textcolor{stringliteral}{"{}s \%s"{}}, str) == 1)}
\DoxyCodeLine{108     \{}
\DoxyCodeLine{109       \textcolor{comment}{// TODO mesh obj loader -\/ usage for s off}}
\DoxyCodeLine{110     \}}
\DoxyCodeLine{111   \}}
\DoxyCodeLine{112 \}}
\DoxyCodeLine{113 }
\DoxyCodeLine{114 \textcolor{preprocessor}{\#endif }\textcolor{comment}{/* \_MESHLOADER\_HPP\_ */}\textcolor{preprocessor}{}}

\end{DoxyCode}
